<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بازی چیستان با ربات</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap');
        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #121212;
            color: #E0E0E0;
        }
        .golden-gradient {
            background: linear-gradient(90deg, #FAD961, #F79521);
        }
        .golden-glow {
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
        }
        .text-golden {
            color: #F7D344;
        }
        .profile-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #F7D344;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #1a1a1a;
            position: relative;
            transition: all 0.3s ease-in-out;
        }
        .profile-icon {
            color: #F7D344;
            width: 24px;
            height: 24px;
        }
        .card {
            background-color: #1a1a1a;
            border-radius: 12px;
            padding: 16px;
        }
        .button {
            border-radius: 9999px;
            padding: 12px 24px;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            cursor: pointer;
            font-weight: bold;
        }
        .button:active {
            transform: scale(0.95);
        }
        .navbar-icon {
            filter: grayscale(100%);
        }
        .active-navbar-icon {
            filter: grayscale(0%);
        }
        .countdown-text {
            font-variant-numeric: tabular-nums;
        }
    </style>
</head>
<body class="bg-[#121212] flex items-center justify-center min-h-screen p-4">

<div id="app" class="w-full max-w-sm mx-auto flex flex-col items-center"></div>

<script>
    // Game data and state management
    const gameData = {
        user: { name: '', age: 0, cups: 0 },
        botNames: ["فاطمه حسینی", "مهتاب جلالی", "Alixc", "a_p_12", "Aria_P24", "MinaK", "Laleh98", "نیما رحیمی", "نرگس راد", "RoyaG"],
        topics: ["سینما", "اطلاعات عمومی", "تاریخ و جغرافیا", "موسیقی و فرهنگ", "علمی و تکنولوژی"],
        questions: {
            "سینما": [
                { q: "فیلم 'جدایی نادر از سیمین' برنده چه جایزه‌ای شد؟", a: "اسکار", options: ["نخل طلا", "اسکار", "گلدن گلوب", "بافتا"] },
                { q: "کارگردان سه‌گانه 'پدرخوانده' کیست؟", a: "فرانسیس فورد کاپولا", options: ["مارتین اسکورسیزی", "استنلی کوبریک", "فرانسیس فورد کاپولا", "استیون اسپیلبرگ"] },
                { q: "کدام بازیگر به عنوان 'مرلین مونرو' سینمای ایران شناخته می‌شود؟", a: "فروزان", options: ["فروزان", "گوگوش", "لیلا فروهر", "سوسن"] },
                { q: "بازیگر نقش اصلی فیلم 'پاپیون' کیست؟", a: "استیو مک‌کوئین", options: ["آل پاچینو", "استیو مک‌کوئین", "داستین هافمن", "ژان گابن"] },
            ],
            "اطلاعات عمومی": [
                { q: "کوچک‌ترین کشور جهان کدام است؟", a: "واتیکان", options: ["واتیکان", "موناکو", "سن مارینو", "نائورو"] },
                { q: "نام واحد پول ژاپن چیست؟", a: "ین", options: ["وون", "ین", "یوآن", "بات"] },
                { q: "نام تنها قاره‌ای که هیچ رودخانه‌ای ندارد چیست؟", a: "قطب جنوب", options: ["آفریقا", "استرالیا", "قطب جنوب", "اروپا"] },
                { q: "کدام حیوان در شب قادر به دیدن در تاریکی مطلق است؟", a: "هیچ حیوانی", options: ["جغد", "گربه", "هیچ حیوانی", "خفاش"] },
            ],
            "تاریخ و جغرافیا": [
                { q: "کدام کشور در آمریکای جنوبی قرار ندارد؟", a: "پرتغال", options: ["پرتغال", "برزیل", "شیلی", "آرژانتین"] },
                { q: "مهمترین بنای تاریخی شهر رم کدام است؟", a: "کولوسئوم", options: ["پانتئون", "کولوسئوم", "برج پیزا", "فروم روم"] },
                { q: "مخترع لامپ کیست؟", a: "توماس ادیسون", options: ["نیکولا تسلا", "توماس ادیسون", "الکساندر گراهام بل", "مایکل فارادی"] },
                { q: "نام طولانی‌ترین رودخانه در جهان چیست؟", a: "نیل", options: ["آمازون", "نیل", "یانگ‌تسه", "میسیسیپی"] },
            ],
            "موسیقی و فرهنگ": [
                { q: "کدام ساز از خانواده سازهای بادی برنجی است؟", a: "ترومپت", options: ["فلوت", "کلارینت", "ترومپت", "ویولن"] },
                { q: "نام نقاش مشهور 'مونالیزا' چیست؟", a: "لئوناردو داوینچی", options: ["ونسان ون‌گوگ", "لئوناردو داوینچی", "پابلو پیکاسو", "رافائل"] },
                { q: "نام مشهورترین اثر ویلیام شکسپیر چیست؟", a: "هملت", options: ["اتللو", "مکبث", "هملت", "رومئو و ژولیت"] },
                { q: "نام کامل شاعر بزرگ ایرانی، حافظ، چیست؟", a: "خواجه شمس‌الدین محمد", options: ["ابوالقاسم فردوسی", "جلال‌الدین محمد بلخی", "خواجه شمس‌الدین محمد", "سعدی"] },
            ],
            "علمی و تکنولوژی": [
                { q: "نام عنصری که عدد اتمی آن ۷۹ است چیست؟", a: "طلا", options: ["نقره", "طلا", "پلاتین", "مس"] },
                { q: "کدام سیاره به عنوان 'سیاره سرخ' شناخته می‌شود؟", a: "مریخ", options: ["مریخ", "ناهید", "مشتری", "عطارد"] },
                { q: "چه چیزی در اطراف خورشید می‌گردد؟", a: "زمین", options: ["ماه", "ستاره دنباله‌دار", "زمین", "شهاب‌سنگ"] },
                { q: "کوچک‌ترین واحد سازنده ماده چیست؟", a: "اتم", options: ["مولکول", "اتم", "کوارک", "پروتون"] },
            ]
        },
        game: {
            screen: 'onboarding',
            isOnlineMode: false,
            currentRound: 0,
            playerScore: 0,
            botScore: 0,
            totalQuestions: 0,
            playerCorrect: 0,
            botCorrect: 0,
            currentQuestionIndex: 0,
            currentTopic: '',
            questionInterval: null,
            roundTimer: null,
            intervalTimer: null,
        }
    };

    // The main render function
    function renderScreen() {
        const app = document.getElementById('app');
        app.innerHTML = '';
        switch (gameData.game.screen) {
            case 'onboarding':
                renderOnboarding();
                break;
            case 'mainMenu':
                renderMainMenu();
                break;
            case 'onlineSearching':
                renderOnlineSearching();
                break;
            case 'game':
                renderGame();
                break;
            case 'endGame':
                renderEndGame();
                break;
            case 'settings':
                renderSettings();
                break;
            case 'navbarPlaceholder':
                renderPlaceholder();
                break;
        }
    }

    // Onboarding screen
    function renderOnboarding() {
        const app = document.getElementById('app');
        app.innerHTML = `
            <div class="card w-full p-6 space-y-6">
                <h1 class="text-3xl font-bold text-center text-golden-glow text-golden">ورود</h1>
                <div class="flex flex-col space-y-4">
                    <input id="username" type="text" placeholder="نام کاربری" class="p-3 bg-gray-800 text-white rounded-lg border border-gray-700 focus:outline-none focus:ring-2 focus:ring-golden-glow">
                    <input id="age" type="number" placeholder="سن" class="p-3 bg-gray-800 text-white rounded-lg border border-gray-700 focus:outline-none focus:ring-2 focus:ring-golden-glow">
                </div>
                <label class="flex items-center space-x-2 space-x-reverse text-sm cursor-pointer">
                    <input type="checkbox" id="agree" class="h-4 w-4 rounded text-golden-glow focus:ring-golden-glow">
                    <span class="text-gray-400">با تمامی قوانین موافقم.</span>
                </label>
                <button id="onboarding-continue" class="button w-full golden-gradient text-gray-900 font-bold">
                    ادامه
                </button>
            </div>
        `;
        document.getElementById('onboarding-continue').addEventListener('click', () => {
            const username = document.getElementById('username').value.trim();
            const age = parseInt(document.getElementById('age').value);
            const agree = document.getElementById('agree').checked;

            if (username && age && agree) {
                gameData.user.name = username;
                gameData.user.age = age;
                gameData.game.screen = 'mainMenu';
                renderScreen();
            } else {
                alert('لطفاً تمامی فیلدها را پر کنید و با قوانین موافقت نمایید.');
            }
        });
    }

    // Main menu screen
    function renderMainMenu() {
        const app = document.getElementById('app');
        app.innerHTML = `
            <div class="w-full flex flex-col h-full">
                <!-- Top Bar -->
                <div class="fixed top-0 left-0 right-0 z-50 flex justify-between items-center px-4 py-4">
                    <div id="settings-btn" class="p-2 cursor-pointer transition-transform duration-200 hover:rotate-45">
                        <svg class="h-8 w-8 text-golden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.82 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.82 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.82-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.82-3.31 2.37-2.37.525.265 1.127.398 1.729.398h.001z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                    </div>
                    <div class="flex items-center space-x-2 space-x-reverse">
                        <div class="flex flex-col items-end">
                            <span class="text-sm font-bold">${gameData.user.name}</span>
                            <span class="text-xs text-golden">${gameData.user.cups} کاپ</span>
                        </div>
                        <div class="profile-circle">
                            <svg class="profile-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </div>
                    </div>
                </div>

                <!-- Main Buttons -->
                <div class="flex flex-col space-y-6 w-full items-center mt-48">
                    <button id="online-btn" class="button w-3/4 text-xl bg-[#2e2e2e] text-golden golden-glow">
                        بازی آنلاین
                    </button>
                    <button id="start-btn" class="button w-3/4 text-xl golden-gradient text-gray-900 golden-glow">
                        شروع بازی
                    </button>
                </div>
            </div>

            <!-- Bottom Navbar -->
            <div class="fixed bottom-0 right-0 w-full flex justify-around bg-[#1a1a1a] rounded-t-2xl p-4">
                <div id="store-btn" class="flex flex-col items-center cursor-pointer">
                    <svg class="w-6 h-6 text-golden navbar-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.183 1.727.707 1.727H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                    </svg>
                    <span class="text-xs mt-1 text-gray-400">فروشگاه</span>
                </div>
                <div id="challenges-btn" class="flex flex-col items-center cursor-pointer">
                    <svg class="w-6 h-6 text-golden navbar-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M10 16h.01" />
                    </svg>
                    <span class="text-xs mt-1 text-gray-400">چالش‌ها</span>
                </div>
                <div id="history-btn" class="flex flex-col items-center cursor-pointer">
                    <svg class="w-6 h-6 text-golden navbar-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <span class="text-xs mt-1 text-gray-400">تاریخچه</span>
                </div>
            </div>
        `;

        document.getElementById('settings-btn').addEventListener('click', () => {
            gameData.game.screen = 'settings';
            renderScreen();
        });
        document.getElementById('start-btn').addEventListener('click', () => {
            gameData.game.isOnlineMode = false;
            gameData.game.screen = 'game';
            resetGame();
            renderScreen();
        });
        document.getElementById('online-btn').addEventListener('click', () => {
            gameData.game.isOnlineMode = true;
            gameData.game.screen = 'onlineSearching';
            renderScreen();
        });
        document.getElementById('store-btn').addEventListener('click', () => {
            gameData.game.screen = 'navbarPlaceholder';
            renderScreen();
        });
        document.getElementById('challenges-btn').addEventListener('click', () => {
            gameData.game.screen = 'navbarPlaceholder';
            renderScreen();
        });
        document.getElementById('history-btn').addEventListener('click', () => {
            gameData.game.screen = 'navbarPlaceholder';
            renderScreen();
        });
    }

    // Searching for online opponent screen
    function renderOnlineSearching() {
        const app = document.getElementById('app');
        app.innerHTML = `
            <div class="flex flex-col items-center justify-center h-full space-y-8 animate-pulse">
                <svg class="h-24 w-24 text-golden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <p class="text-lg text-gray-400">در حال جستجوی حریف...</p>
            </div>
        `;
        setTimeout(() => {
            gameData.game.screen = 'game';
            resetGame();
            const randomBotName = gameData.botNames[Math.floor(Math.random() * gameData.botNames.length)];
            gameData.game.bot = { name: randomBotName, cups: Math.floor(Math.random() * 1000) };
            renderScreen();
        }, 3000);
    }

    // Game screen with rounds
    function renderGame() {
        const app = document.getElementById('app');
        const topic = gameData.topics[gameData.game.currentRound];
        const question = gameData.game.currentQuestion;
        app.innerHTML = `
            <div class="w-full flex flex-col h-full">
                <!-- Top Bar -->
                <div class="flex justify-between items-center w-full p-4 mb-4">
                    <div class="flex flex-col items-center">
                        <span class="text-xs text-gray-400">شما</span>
                        <span class="text-lg text-golden font-bold">${gameData.game.playerCorrect}</span>
                    </div>
                    <div class="text-2xl font-bold text-white countdown-text" id="round-timer">۴۰</div>
                    <div class="flex flex-col items-center">
                        <span class="text-xs text-gray-400">حریف</span>
                        <span class="text-lg text-golden font-bold" id="bot-score-display">${gameData.game.isOnlineMode ? gameData.game.botCorrect : ''}</span>
                    </div>
                </div>

                <!-- Round Introduction and Countdown -->
                <div id="round-intro" class="flex flex-col items-center justify-center h-full absolute inset-0 bg-black bg-opacity-80 z-20 transition-opacity duration-500">
                    <h2 class="text-2xl font-bold text-white mb-4">موضوع: ${topic}</h2>
                    <p class="text-lg text-gray-400">شروع بازی در...</p>
                    <p id="interval-countdown" class="text-5xl text-golden font-bold mt-2 countdown-text">۱۰</p>
                </div>
                
                <!-- Question Card -->
                <div id="question-card" class="card w-full flex flex-col items-center p-4 golden-glow" style="display:none;">
                    <span class="text-sm text-gray-400 mb-2">راند ${gameData.game.currentRound + 1} از ۳</span>
                    <p class="text-center text-lg font-semibold mb-6">${question ? question.q : ''}</p>
                    <div class="w-full space-y-4">
                        ${question ? question.options.map((opt, i) => `
                            <button class="option-btn button w-full bg-[#2e2e2e] text-white" data-answer="${opt}">
                                ${opt}
                            </button>
                        `).join('') : ''}
                    </div>
                </div>
            </div>
        `;
        document.querySelectorAll('.option-btn').forEach(button => {
            button.addEventListener('click', handleAnswer);
        });

        startRoundInterval();
    }

    // End game screen
    function renderEndGame() {
        const app = document.getElementById('app');
        const winnerText = gameData.game.isOnlineMode
            ? (gameData.game.playerCorrect > gameData.game.botCorrect ? 'شما برنده شدید!' : (gameData.game.playerCorrect < gameData.game.botCorrect ? 'حریف برنده شد.' : 'بازی مساوی شد.'))
            : 'بازی به پایان رسید.';

        app.innerHTML = `
            <div class="card w-full p-6 space-y-6 text-center golden-glow">
                <h2 class="text-2xl font-bold text-golden">${winnerText}</h2>
                ${gameData.game.isOnlineMode ? `
                <div class="flex justify-between w-full font-bold text-lg">
                    <span>شما</span>
                    <span>${gameData.game.playerCorrect} درست</span>
                </div>
                <div class="flex justify-between w-full font-bold text-lg">
                    <span>${gameData.game.bot.name}</span>
                    <span>${gameData.game.botCorrect} درست</span>
                </div>` : `
                <div class="flex justify-between w-full font-bold text-lg">
                    <span>تعداد پاسخ‌های درست:</span>
                    <span>${gameData.game.playerCorrect}</span>
                </div>
                `}
                <div class="flex flex-col space-y-4 mt-6">
                    <button id="return-to-menu-btn" class="button w-full bg-[#2e2e2e] text-golden">
                        بازگشت به منو
                    </button>
                    <button id="review-questions-btn" class="button w-full bg-[#2e2e2e] text-golden">
                        مرور سوال‌ها
                    </button>
                    <button id="share-btn" class="button w-full golden-gradient text-gray-900">
                        اشتراک‌گذاری
                    </button>
                </div>
            </div>
        `;

        document.getElementById('return-to-menu-btn').addEventListener('click', () => {
            gameData.game.screen = 'mainMenu';
            renderScreen();
        });
        document.getElementById('review-questions-btn').addEventListener('click', () => {
            alert('این قابلیت هنوز پیاده‌سازی نشده است.');
        });
        document.getElementById('share-btn').addEventListener('click', () => {
            alert('این قابلیت هنوز پیاده‌سازی نشده است.');
        });
    }

    // Settings screen
    function renderSettings() {
        const app = document.getElementById('app');
        app.innerHTML = `
            <div class="card w-full p-6 space-y-4">
                <h2 class="text-2xl font-bold text-golden text-center">تنظیمات</h2>
                <div class="space-y-3">
                    <p class="card p-3">کد هدیه: این بخش به زودی فعال می‌شود.</p>
                    <p class="card p-3">سازندگان: تیم توسعه در حال کار روی بهبود بازی است.</p>
                    <p class="card p-3">پشتیبانی: برای هرگونه سوال یا مشکل با ما در ارتباط باشید.</p>
                </div>
                <button id="back-to-menu-btn" class="button w-full golden-gradient text-gray-900 mt-6">
                    بازگشت
                </button>
            </div>
        `;
        document.getElementById('back-to-menu-btn').addEventListener('click', () => {
            gameData.game.screen = 'mainMenu';
            renderScreen();
        });
    }

    // Placeholder screen for navbar items
    function renderPlaceholder() {
        const app = document.getElementById('app');
        app.innerHTML = `
            <div class="card w-full p-6 space-y-4 text-center">
                <h2 class="text-2xl font-bold text-golden">این صفحه در دست ساخت است!</h2>
                <p class="text-gray-400">به زودی ویژگی‌های جدیدی به بازی اضافه می‌شود.</p>
                <button id="back-to-menu-btn" class="button w-full golden-gradient text-gray-900 mt-6">
                    بازگشت به منو
                </button>
            </div>
        `;
        document.getElementById('back-to-menu-btn').addEventListener('click', () => {
            gameData.game.screen = 'mainMenu';
            renderScreen();
        });
    }

    // Game logic functions
    function resetGame() {
        gameData.game.playerScore = 0;
        gameData.game.botScore = 0;
        gameData.game.currentRound = 0;
        gameData.game.playerCorrect = 0;
        gameData.game.botCorrect = 0;
        gameData.game.currentQuestionIndex = 0;
        if (gameData.game.roundTimer) clearInterval(gameData.game.roundTimer);
        if (gameData.game.intervalTimer) clearInterval(gameData.game.intervalTimer);
    }

    function startRoundInterval() {
        const introScreen = document.getElementById('round-intro');
        const countdownElement = document.getElementById('interval-countdown');
        let count = 10;
        introScreen.style.display = 'flex';

        gameData.game.intervalTimer = setInterval(() => {
            count--;
            countdownElement.innerText = count;
            if (count <= 0) {
                clearInterval(gameData.game.intervalTimer);
                introScreen.style.display = 'none';
                startGameRound();
            }
        }, 1000);
    }

    function startGameRound() {
        gameData.game.currentQuestionIndex = 0;
        let timeRemaining = 40;
        const timerElement = document.getElementById('round-timer');
        const questionCard = document.getElementById('question-card');
        questionCard.style.display = 'flex';

        timerElement.innerText = timeRemaining;
        gameData.game.roundTimer = setInterval(() => {
            timeRemaining--;
            timerElement.innerText = timeRemaining;
            if (timeRemaining <= 0) {
                clearInterval(gameData.game.roundTimer);
                endGameRound();
            }
        }, 1000);

        displayNextQuestion();
    }

    function displayNextQuestion() {
        const topic = gameData.topics[gameData.game.currentRound];
        const questionsForTopic = gameData.questions[topic];

        if (gameData.game.currentQuestionIndex >= questionsForTopic.length) {
            endGameRound();
            return;
        }

        const question = questionsForTopic[gameData.game.currentQuestionIndex];
        gameData.game.currentTopic = topic;
        gameData.game.currentQuestion = question;
        gameData.game.currentQuestionIndex++;

        // Update UI
        const questionCard = document.getElementById('question-card');
        questionCard.innerHTML = `
            <span class="text-sm text-gray-400 mb-2">راند ${gameData.game.currentRound + 1} از ۳</span>
            <p class="text-center text-lg font-semibold mb-6">${question.q}</p>
            <div class="w-full space-y-4">
                ${question.options.map((opt, i) => `
                    <button class="option-btn button w-full bg-[#2e2e2e] text-white" data-answer="${opt}">
                        ${opt}
                    </button>
                `).join('')}
            </div>
        `;
        document.querySelectorAll('.option-btn').forEach(button => {
            button.addEventListener('click', handleAnswer);
        });

        if (gameData.game.isOnlineMode) {
            botAnswer();
        }
    }

    function handleAnswer(event) {
        const selectedAnswer = event.target.dataset.answer;
        const isCorrect = selectedAnswer === gameData.game.currentQuestion.a;
        if (isCorrect) {
            gameData.game.playerCorrect++;
        }
        document.getElementById('round-timer').style.backgroundColor = isCorrect ? 'green' : 'red';
        setTimeout(() => {
            document.getElementById('round-timer').style.backgroundColor = '';
        }, 500);

        const correctButton = Array.from(document.querySelectorAll('.option-btn')).find(b => b.dataset.answer === gameData.game.currentQuestion.a);
        const allButtons = document.querySelectorAll('.option-btn');
        allButtons.forEach(btn => {
            btn.disabled = true;
            if (btn === event.target) {
                btn.classList.add(isCorrect ? 'bg-green-600' : 'bg-red-600', 'text-white');
            } else if (btn === correctButton) {
                btn.classList.add('bg-green-600', 'text-white');
            }
        });
        
        setTimeout(() => {
            displayNextQuestion();
        }, 1500);
    }

    function endGameRound() {
        clearInterval(gameData.game.roundTimer);
        gameData.game.currentRound++;
        if (gameData.game.currentRound < 3) {
            gameData.game.screen = 'game';
            renderScreen();
        } else {
            gameData.game.screen = 'endGame';
            renderScreen();
        }
    }

    function botAnswer() {
        const question = gameData.game.currentQuestion;
        const botScoreDisplay = document.getElementById('bot-score-display');
        const botLogic = () => {
            const botChoice = Math.random();
            if (botChoice < 0.6) {
                const isCorrect = Math.random() < 0.7;
                if (isCorrect) {
                    gameData.game.botCorrect++;
                }
            }
            if (botScoreDisplay) {
                 botScoreDisplay.innerText = gameData.game.botCorrect;
            }
        };

        const responseTime = Math.random() * 2500 + 500; // 0.5 to 3 seconds
        setTimeout(botLogic, responseTime);
    }

    // Start the application
    document.addEventListener('DOMContentLoaded', () => {
        renderScreen();
    });
</script>

</body>
</html>
